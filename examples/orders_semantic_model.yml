semantic_models:
  - name: orders
    description: "Order fact table containing transaction data at the order level"
    model: ref('dim_orders')
    defaults:
      agg_time_dimension: order_date
    
    entities:
      - name: order_id
        type: primary
        description: "Unique identifier for each order"
      - name: customer_id
        type: foreign
        expr: customer_id
        description: "Foreign key to customer dimension"
      - name: location_id
        type: foreign
        expr: store_location_id
        description: "Foreign key to location dimension"
    
    dimensions:
      - name: order_date
        type: time
        expr: date_trunc('day', order_date)
        type_params:
          time_granularity: day
        description: "Date when the order was placed"
      - name: order_status
        type: categorical
        description: "Current status of the order"
      - name: is_large_order
        type: categorical
        expr: case when order_total > 100 then true else false end
        description: "Flag indicating if order value exceeds $100"
    
    measures:
      - name: order_total
        description: "Total value of the order including taxes"
        agg: sum
      - name: order_count
        description: "Count of individual orders"
        expr: 1
        agg: sum
      - name: avg_order_value
        description: "Average order value"
        expr: order_total
        agg: avg
      - name: unique_customers
        description: "Count of unique customers"
        expr: customer_id
        agg: count_distinct 